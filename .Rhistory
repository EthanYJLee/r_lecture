plot(diabetes$PhysHlth, dnorm(diabetes$PhysHlth))
dnorm(diabetes$PhysHlth)
plot(dnorm(diabetes$PhysHlth))
plot(t(dnorm(diabetes$PhysHlth)))
summary(diabetes$PhysHlth)
# mean: 5.81
sd(diabetes$PhysHlth)
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,5.81,10.06226))
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,5.81,10.06226),type="l")
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,5.81,10.06226),type="o")
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,5.81,10.06226))
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226))
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226,log = TRUE))
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226))
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226), line="l")
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226), type="l")
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226), type = "l")
# sd: 10.06226
plot(diabetes$PhysHlth,dnorm(diabetes$PhysHlth,mean=5.81,sd=10.06226))
par(family="AppleGothic")
plot(table(as.data.frame((subset(diabetes, PhysHlth>0))[,14])),ylab="PhysHlth", xlab="일수/1개월", cex.axis=0.6)
# <16, 16-17, 17-18.5, 18.5-25,25-30, 30-35,35-40,40<
# 16,17,18.5,25,30,35,40
par(family="AppleGothic")
plot(table(diabetes$BMI),ylab="", xlab="BMI수치", cex.axis=0.6)
abline(v=13, lwd=2, col="blue")
abline(v=16, lwd=2, col="red")
abline(v=17, lty=2,lwd=1, col="red")
abline(v=18.5, lty=2,lwd=1, col="red")
abline(v=25, lty=2,lwd=1, col="red")
abline(v=30, lty=2,lwd=1, col="red")
abline(v=35, lty=2,lwd=1, col="red")
abline(v=40, lwd=2, col="red")
abline(v=45, lwd=2, col="blue")
legend("topright",legend=c("BMI 범위 구분","이상치 기준"),fill=c("red","blue"),box.lty=0,cex=0.8)
# 이상치의 비율 확인
subset(diabetes, BMI<13 | BMI>45) # 2181 rows
2181/nrow(diabetes)
plot(table(as.data.frame((subset(diabetes, PhysHlth>0))[,14]))
plot(table(as.data.frame((subset(diabetes, PhysHlth>0))[,14])))
plot(table(as.data.frame((subset(diabetes, PhysHlth>0))[,14])))
boxplot(table(as.data.frame((subset(diabetes, PhysHlth>0))[,14])))
# 모든 physical health Boxplot
boxplot(diabetes$PhysHlth)
# 한 번이라도 신체적 불편을 경험한 경우 Boxplot
boxplot(table(as.data.frame((subset(diabetes, PhysHlth>0))[,14])))
# 한 번이라도 신체적 불편을 경험한 경우 Boxplot
boxplot(table(as.data.frame(t(subset(diabetes, PhysHlth>0))[,14])))
# 모든 physical health Boxplot
boxplot(t(diabetes$PhysHlth))
# 모든 physical health Boxplot
boxplot(as.data.frame(t(diabetes$PhysHlth)))
# 모든 physical health Boxplot
boxplot(as.table(t(diabetes$PhysHlth)))
# 한 번이라도 신체적 불편을 경험한 경우 Boxplot
boxplot(table(as.data.frame(t(subset(diabetes, PhysHlth>0))[,14])))
# 모든 physical health Boxplot
boxplot(as.table(t(diabetes$PhysHlth)))
# 한 번이라도 신체적 불편을 경험한 경우
boxplot(table(as.data.frame(t(subset(diabetes, PhysHlth>0))[,14])))
# 한 번이라도 신체적 불편을 경험한 경우
boxplot(table(as.data.frame(subset(diabetes, PhysHlth>0))[,14]))
# 모든 physical health Boxplot
boxplot(as.table(t(diabetes$PhysHlth)))
# 모든 physical health Boxplot
boxplot(as.table((subset(diabetes, PhysHlth>0))[,14]))
boxplot(as.table((subset(diabetes, PhysHlth>=0))[,14]))
boxplot(as.table((subset(diabetes, PhysHlth>0))[,14]))
# 한 번이라도 신체적 불편을 경험한 경우
boxplot(as.table((subset(diabetes, PhysHlth>0))[,14]))
# 한 번이라도 정신적 불편을 경험한 경우
boxplot(as.table((subset(diabetes, MentHlth>0))[,13]))
# 한 번이라도 정신적 불편을 경험한 경우
boxplot(as.table((subset(diabetes, MentHlth>=0))[,13]))
# 한 번이라도 정신적 불편을 경험한 경우
boxplot(as.table((subset(diabetes, MentHlth>0))[,13]))
nnet_diabetes <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/nnet_diabetes.rds")
nnet_diabetes
randomRegres4_dementia <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/randomRegres4_dementia.rds")
random_dementia <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/random_dementia.rds")
randomForest_stroke <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/randomForest_stroke.rds")
Rserve()
install.packages("Rserve")
library(Rserve)
Rserve()
Rserve --no-save
Rserve(args="--no-save")
Rserve(args="--no-save")
R CMD Rserve --no-save
install.packages("Rserve")
/var/folders/k_/0wcctvbj41ncld1_xmh98p6w0000gn/T//RtmptXlyR9/downloaded_packages
install.packages('Rserve')
library(Rserve)
install.packages('randomForest')
library(randomForest)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
install.packages("rJava")
library(rJava)
rJava
library(rJava)
install.packages('Rserve')
library(Rserve)
install.packages('randomForest')
library(randomForest)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
install.packages("randomForest")
install.packages('Rserve')
randomForest_Iris <- readRDS("~/Development/apache-tomcat-9.0.70/webapps/ROOT/Rserve/randomForest_Iris.rds")
randomForest_Iris
nnet_diabetes <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/nnet_diabetes.rds")
random_dementia <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/random_dementia.rds")
randomForest_stroke <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/randomForest_stroke.rds")
randomRegres4_dementia <- readRDS("~/Development/Flutter/Flutter_R_Project_youngjin/dr_oh_spring/src/main/webapp/randomRegres4_dementia.rds")
library(Rserve)
Rserve()
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
Rserve(TRUE)
Rserve(args="--RS-conf C:\\folder\\Rserv.cfg")
install.packages("Rserve",,"http://rforge.net")
install.packages("Rserve", , "http://rforge.net")
R CMD INSTALL Rserve_1.8-12.tar.gz
Rserve(args="--no-save")
install.packages("Rserve")
library(Rserve)
.libPaths()
install.packages('Rserve')
library(Rserve)
install.packages('randomForest')
library(randomForest)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
library(Rserve)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
sessionInfo()
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
Rserve(FALSE, port=8080, args = '--RS-encoding utf8 --no-save')
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
library(Rserve)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
.libPaths()
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
.libPaths()
install.packages("Rserve")
library(Rserve)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
q()
shiny::runGadget(sparklyr::connection_spark_shinyapp(), viewer = .rs.embeddedViewer)
library(sparklyr)
library(dplyr)
spark_install(version = "2.4.3", hadoop_version = "2.7")
sc <- spark_connect(master = "local")
shiny::runGadget(sparklyr::connection_spark_shinyapp(), viewer = .rs.embeddedViewer)
library(sparklyr)
library(dplyr)
sc <- spark_connect(master = "local")
install.packages('Rserve')
library(Rserve)
install.packages('randomForest')
library(randomForest)
Rserve(FALSE, port=6311, args = '--RS-encoding utf8 --no-save')
install.packages('Rserve')
install.packages("Rserve")
library(Rserve)
Rserve()
diabetes<-read.csv("./Data/diabetes_data.csv")
head(diabetes)
diabetes$Diabetes<-as.factor(diabetes$Diabetes)
diabetes$Sex<-as.factor(diabetes$Sex)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
library(dplyr)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
install.packages("dplyr")
library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
diabetes<-read.csv("./Data/diabetes_data.csv")
head(diabetes)
diabetes$Diabetes<-as.factor(diabetes$Diabetes)
diabetes$Sex<-as.factor(diabetes$Sex)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
install.packages("dplyr")
library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
set.seed(1234)
library(caret)
install.packages("dplyr")
diabetes<-read.csv("./Data/diabetes_data.csv")
head(diabetes)
diabetes$Diabetes<-as.factor(diabetes$Diabetes)
diabetes$Sex<-as.factor(diabetes$Sex)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
install.packages("dplyr")
library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
set.seed(1234)
install.packages("caret")
library(caret)
install.packages("caret")
install.packages("dplyr")
diabetes<-read.csv("./Data/diabetes_data.csv")
head(diabetes)
diabetes$Diabetes<-as.factor(diabetes$Diabetes)
diabetes$Sex<-as.factor(diabetes$Sex)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
install.packages("dplyr")
library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
set.seed(1234)
install.packages("caret")
install.packages("dplyr")
library(caret)
samp<-createDataPartition(diabetes$Diabetes,p=0.7,list=F)
data.train<-diabetes[samp,]
data.test<-diabetes[-samp,]
library(randomForest)
x<-subset(data.test,select=-Diabetes)
y<-data.test$Diabetes
rf<-randomForest(Diabetes~.,data = data.train,ntree=100)
pred<-predict(rf,x)
mean(pred==y)
table(pred,y)
str(diabetes)
summary(diabetes$Age)
summary(diabetes$Diabetes)
par(cex.axis=0.2)
boxplot(diabetes)
cor(as.numeric(diabetes$Diabetes),diabetes$Age)
cor(as.numeric(diabetes$Diabetes),diabetes$BMI)
lm(diabetes$Diabetes~diabetes$Age)
lm(diabetes$Diabetes~diabetes$BMI)
library(ggplot2)
library(factoextra)
diabetes<-read.csv("./Data/diabetes_data.csv")
head(diabetes)
diabetes$Diabetes<-as.factor(diabetes$Diabetes)
diabetes$Sex<-as.factor(diabetes$Sex)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
install.packages("dplyr")
library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
set.seed(1234)
install.packages("caret")
library(caret)
samp<-createDataPartition(diabetes$Diabetes,p=0.7,list=F)
data.train<-diabetes[samp,]
data.test<-diabetes[-samp,]
library(randomForest)
x<-subset(data.test,select=-Diabetes)
y<-data.test$Diabetes
rf<-randomForest(Diabetes~.,data = data.train,ntree=100)
install.packages("caret")
install.packages("dplyr")
pred<-predict(rf,x)
mean(pred==y)
table(pred,y)
str(diabetes)
summary(diabetes$Age)
summary(diabetes$Diabetes)
par(cex.axis=0.2)
boxplot(diabetes)
cor(as.numeric(diabetes$Diabetes),diabetes$Age)
cor(as.numeric(diabetes$Diabetes),diabetes$BMI)
lm(diabetes$Diabetes~diabetes$Age)
lm(diabetes$Diabetes~diabetes$BMI)
install.packages("ggplot2")
install.packages("factoextra")
install.packages("ggplot2")
install.packages("dplyr")
library(ggplot2)
library(factoextra)
data<-diabetes
data$Diabetes<-as.numeric(data$Diabetes)
data$Sex<-as.numeric(data$Sex)
data
head(scale(data),n=1)
age1<-subset(diabetes,Age==1)
plot(table(diabetes$Age))
kmeans(age1,1,nstart = 25)
stroke<-read.csv("./Data/stroke_data.csv")
stroke$work_type<-as.factor(stroke$work_type)
table(stroke$age<0)
boxplot(stroke$age)
library(dplyr)
stroke<-arrange(stroke, stroke)
tail(stroke)
table(stroke$age)
table(stroke$stroke)
plot(stroke$age,stroke$stroke)
stroke$stroke<-as.factor(stroke$stroke)
stroke$sex<-as.factor(stroke$sex)
stroke
nrow(subset(subset(stroke,stroke=="0"),sex=="0"))
nrow(subset(subset(stroke,stroke=="0"),sex=="1"))
nrow(subset(subset(stroke,stroke=="1"),sex=="0"))
nrow(subset(subset(stroke,stroke=="1"),sex=="1"))
#stroke$age<-ifelse(stroke$age<0,NA,stroke$age)
#stroke$age<-ifelse(stroke$age<18,NA,stroke$age)
sum(is.na(stroke$age))
# 나이 NA 제거
stroke<-na.omit(stroke)
table(stroke$stroke)
stroke
stroke.above18<-read.csv("./Data/stroke_data.csv")
stroke.above18$work_type<-as.factor(stroke.above18$work_type)
stroke.above18$age<-ifelse(stroke.above18$age<18,NA,stroke.above18$age)
stroke.above18<-na.omit(stroke.above18)
stroke.above18 # 38309/40910
table(stroke.above18$age)
stroke.above0<-read.csv("./Data/stroke_data.csv")
stroke.above0$work_type<-as.factor(stroke.above0$work_type)
stroke.above0$age<-ifelse(stroke.above0$age<0,NA,stroke.above0$age)
stroke.above0<-na.omit(stroke.above0)
stroke.above0 # 40849/40910
table(stroke.above0$age)
table(stroke.above0$age<0)
table(stroke.above18$age<18)
re.stroke.above18<-lm(stroke~.,data = stroke.above18)
re.stroke.above0<-lm(stroke~.,data = stroke.above0)
summary(re.stroke.above18)
summary(re.stroke.above0)
summary(step(re.stroke.above18, direction = "backward"))
install.packages("dplyr")
summary(step(re.stroke.above0, direction = "backward"))
boxplot(stroke.above0)
boxplot(stroke.above18)
set.seed(1234)
library(caret)
samp<-createDataPartition(stroke.above0$stroke,p=0.7,list=F)
stroke.above0.train<-stroke.above0[samp,]
stroke.above0.test<-stroke.above0[-samp,]
library(randomForest)
x<-subset(stroke.above0.test,select=-stroke)
y<-stroke.above0.test$stroke
stroke.above0.train$stroke<-as.factor(stroke.above0.train$stroke)
rf<-randomForest(stroke~.,data = stroke.above0.train,ntree=100)
pred<-predict(rf,x)
mean0<-mean(pred==y)
table0<-table(pred,y)
mean0
table0
set.seed(1234)
library(caret)
samp<-createDataPartition(stroke.above18$stroke,p=0.7,list=F)
stroke.above18.train<-stroke.above18[samp,]
stroke.above18.test<-stroke.above18[-samp,]
library(randomForest)
x<-subset(stroke.above18.test,select=-stroke)
y<-stroke.above18.test$stroke
stroke.above18.train$stroke<-as.factor(stroke.above18.train$stroke)
rf<-randomForest(stroke~.,data = stroke.above18.train,ntree=100)
pred<-predict(rf,x)
mean18<-mean(pred==y)
table18<-table(pred,y)
mean18
table18
# 나이 컬럼 분류
stroke.above0$age<-cut(stroke.above0$age, breaks = c(0,18,30,40,50,60,70,80,Inf),labels = c("유아청소년","20대","30대","40대","50대","60대","70대","80대 이상"))
table(stroke.above0$age)
# 나이 컬럼 분류
stroke.above18$age<-cut(stroke.above18$age, breaks = c(17,30,40,50,60,70,80,Inf),labels = c("20대","30대","40대","50대","60대","70대","80대 이상"))
table(stroke.above18$age)
summary(lm(as.numeric(stroke)~age,data = stroke.above0))
summary(lm(as.numeric(stroke)~age,data = stroke.above18))
stroke.above0
stroke.above18
num0<-c()
num0=append(num0,length(unique(stroke.above0$age)))
num18<-c()
num18=append(num18,length(unique(stroke.above18$age)))
num0
num18
stroke<-read.csv("./Data/stroke_data.csv")
stroke$age<-ifelse(stroke$age<0,NA,stroke$age)
stroke<-na.omit(stroke)
str(stroke)
summary(stroke$age)
cor(stroke$stroke, stroke$hypertension)
stroke<-read.csv("./Data/stroke_data.csv")
colnames(stroke)
table(stroke$age)
as.data.frame(colnames(stroke))
as.data.frame(colnames(diabetes))
cor(stroke)
cor(diabetes)
diabetes.columns
diabetes
diabetes.info
str(diabetes)
str(diabetes)
str(stroke)
desc(diabetes)
summary(diabetes)
factor(diabetes)
table(diabetes)
install.packages(psych)
library(psych)
install.packages("psych")
library(psych)
psych(diabetes)
describeBy(diabetes, group = null)
describeBy(diabetes)
describeBy(diabetes).head(18)
describeBy(diabetes)
diabetes<-read.csv("./Data/diabetes_data.csv")
str(diabetes)
head(diabetes)
diabetes$Diabetes<-as.factor(diabetes$Diabetes)
diabetes$Sex<-as.factor(diabetes$Sex)
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
install.packages("dplyr")
library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
set.seed(1234)
install.packages("caret")
library(caret)
samp<-createDataPartition(diabetes$Diabetes,p=0.7,list=F)
data.train<-diabetes[samp,]
data.test<-diabetes[-samp,]
library(randomForest)
x<-subset(data.test,select=-Diabetes)
y<-data.test$Diabetes
rf<-randomForest(Diabetes~.,data = data.train,ntree=100)
describeBy(stroke)
sum(is.na(diabetes))
str(is.na(diabetes))
sum(is.na(diabetes))
diabetes<-read.csv("./Data/diabetes_data.csv")
colSums(is.na(diabetes))
stroke<-read.csv("./Data/stroke_data.csv")
stroke$work_type<-as.factor(stroke$work_type)
table(stroke$age<0)
boxplot(stroke$age)
colSums(is.na(stroke))
data.frame(colSums(is.na(stroke)))
boxplot(diabetes$BMI) #
boxplot(diabetes$Age)
# install.packages("dplyr")
# library(dplyr)
boxplot(diabetes$BMI)$stats # 13, 25, 29, 33, 45
# BMI 이상치 제거
diabetes$BMI<-ifelse(diabetes$BMI < 13 | diabetes$BMI > 45, NA, diabetes$BMI)
table(is.na(diabetes$BMI)) # 68511:2181
2181/(68511+2181) # 3%
diabetes<-na.omit(diabetes)
diabetes
table(diabetes$Diabetes) # 34859:33652
table(diabetes$Age)
